function bg_show_ogm(saveFigures, calNo)
% Show steady state results
% Assumes that steady state has been computed and saved
% ------------------------------------------------

cS = const_ogm(calNo);
expNo = cS.expBase;


%%  What to show?

% Age wealth profiles
showAgeWealth = 01;
% Wealth distribution by age
showAgeWealthDistr = 01;
% Show Lorenz curves for wealth by age
showAgeWealthLorenz = 01;
% Consumption income parallel
showConsIncome = 01;
% Consumption function by wealth
showConsWealth = 01;


%% Load parameters and steady state results
paramS = var_load_ogm(cS.vParams, calNo, expNo);
bgpS = var_load_ogm(cS.vBgp, calNo, expNo);



%%  Wealth distribution
if 0  % +++++
   disp(' ');
   disp('WEALTH DISTRIBUTION');
   % Compute the wealth distribution
   % Use these percentile classes
   pctUbV = [0.5 0.8 0.95 0.99];
   % Compute Gini
   gini = gini_weighted( bgpS.kHistM(:), ones([nAge * nSim, 1]), 0, dbg );
   % Compute fraction held by each percentile class
   pct_dist_lh(bgpS.kHistM, ones([nAge, nSim]), pctUbV, 1, dbg);
   disp(sprintf('Wealth Gini: %5.2f', gini));
end



%% Age wealth profiles
% Average wealth by age, scaled by economy wide mean earnings
ageWealthV = mean(bgpS.kHistM) ./ bgpS.avgEarn;

if showAgeWealth == 1
   fh = figures_lh.new(cS.figOptS, 1);
   plot(cS.physAgeV(:), ageWealthV(:), '-');
   xlabel('Age in years');
   ylabel('Wealth / mean earnings');
   figure_format_821(fh, 'line');
   figFn = fig_fn_ogm('age_wealth', calNo, expNo);
   figures_lh.fig_save_lh(figFn, saveFigures, 0, cS.figOptS);
end




%% Wealth distribution by age 
if showAgeWealthDistr == 1
   % Show these percentiles
   percentileV = [0.1 0.25 0.5 1];
   % Plot the first np profiles
   np = length(percentileV) - 1;

   % Compute percentiles of wealth distribution by age
   awdM = zeros([cS.aD, np]);
   % Wealth gini by age
   giniV = zeros([1, cS.aD]);
   legendV = cell([np+1, 1]);

   for a = 1 : cS.aD
      % Scaled wealth in this age
      aWealthV = bgpS.kHistM(:, a) ./ bgpS.avgEarn;
      if any(aWealthV > 0.01)
         % Compute distribution
         [~, upperV] = distrib_lh.pcnt_weighted(aWealthV, 1, percentileV, cS.dbg);
         awdM(a,:) = upperV(1:np);
         % Gini.
         giniV(a) = distrib_lh.gini_weighted(aWealthV, ones(size(aWealthV)), cS.dbg);
      end
   end

   % Show the plot
   fh = figures_lh.new(cS.figOptS, 1);
   hold on;
   for ip = 1 : np
      plot(cS.physAgeV(:), awdM(:,ip), '-');
      % Construct the legend
      legendV{ip} = sprintf('%4.1f-th percentile', 100 .* percentileV(ip));
   end
   % Also plot mean profiles
   plot(cS.physAgeV(:), ageWealthV(:), '--');
   legendV{np+1} = 'Mean';
   hold off;

   xlabel('Age in years');
   ylabel('Wealth / mean earnings');
   legend(legendV);

   figure_format_821(fh, 'line');
   figFn = fig_fn_ogm('age_wealth_dist', calNo, expNo);
   figures_lh.fig_save_lh(figFn, saveFigures, 0, cS.figOptS);

   
   % ***** Show ginis by age *****
   if 01
      fh = figures_lh.new(cS.figOptS, 1);
      plot(cS.physAgeV(2:end), giniV(2:end), '-');
      xlabel('Age in years');
      ylabel('Wealth Gini');

      figure_format_821(fh, 'line');
      figFn = fig_fn_ogm('age_wealth_gini', calNo, expNo);
      figures_lh.fig_save_lh(figFn, saveFigures, 0, cS.figOptS);
   end
end


%% Lorenz curves of wealth by age 
if showAgeWealthLorenz == 1
   % Show for these physical ages
   showAgeV = [30 45 60 75];
   ageV = showAgeV - cS.age1 + 1;
   fh = figures_lh.new(cS.figOptS, 1);
   for ia = 1 : length(ageV);
      a = ageV(ia);
      subplot(2,2,ia);
      yV = cumsum(sort(bgpS.kHistM(:,a)));
      plot(linspace(0, 100, cS.nSim), 100 .* yV ./ yV(end), '-');
      figure_format_821(fh, 'line');
      xlabel('Wealth percentile');
      ylabel('Cumulative fraction held');
   end

   figFn = fig_fn_ogm('age_wealth_lorenz', calNo, expNo);
   figures_lh.fig_save_lh(figFn, saveFigures, 0, cS.figOptS);
end


% *********  Consumption and income  **********
if showConsIncome == 1
   % Income by [age, individual]
   incomeM = bgpS.lHistM .* bgpS.wageNet + bgpS.kHistM .* (bgpS.R - 1);
   % Mean income by age
   ageIncomeV = mean(incomeM, 2);
   % Mean consumption by age
   ageConsV = mean(bgpS.cHistM, 2);

   fh = figures_lh.new(cS.figOptS, 1);
   plot(physAgeV(:), ageIncomeV(:), 'k.-',  physAgeV(:), ageConsV(:), 'b+-');
   xlabel('Age in years', 'FontSize', labelFontSize);
   ylabel('Consumption and Income', 'FontSize', labelFontSize);
   title('Consumption Income Parallel', 'FontSize', titleFontSize);
   legend('Income', 'Consumption', 0);
   grid on;

   figure_format_821(fh, 'line');
   figFn = fig_fn_ogm('cons_income', calNo, expNo);
   figures_lh.fig_save_lh(figFn, saveFigures, 0, cS.figOptS);
end


% *********  Consumption by wealth  ***********
if showConsWealth == 1
   % Show these wealth levels
   idxV = 1 : round(cS.nk ./ 2);
   % Show this earnings state
   ie = 1;  % +++++++  round(cS.nw ./ 2);
   % Show these physical ages
   showAgeV = [25 40 55 70];
   % Translate into model ages
   modelAgeV = model_age_ogm(showAgeV, cS, dbg);

   fh = figures_lh.new(cS.figOptS, 1);
   hold on;
   for ia = 1 : length(modelAgeV);
      a = modelAgeV(ia);
      if a >= 1
         plot(paramS.kGridV(idxV), bgpS.cPolM(idxV, ie, a)', cS.colorV{ia});
         legendV{ia} = sprintf('Age %i', showAgeV(ia));
      end
   end
   grid on;
   xlabel('Wealth');
   ylabel('Consumption');
   title('Consumption functions');
   legend(legendV{find(modelAgeV >= 1)}, 0);

   figure_format_821(fh, 'line');
   figFn = fig_fn_ogm('cons_wealth', calNo, expNo);
   figures_lh.fig_save_lh(figFn, saveFigures, 0, cS.figOptS);
end

end